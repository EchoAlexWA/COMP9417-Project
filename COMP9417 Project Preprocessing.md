# Overview

1. Missing Values
2. Anomalies
3. Features Engineering

**ğŸ§© 1. Missing Valuesï¼ˆç¼ºå¤±å€¼å¤„ç†ï¼‰**

**âœ³ æ•°æ®èƒŒæ™¯**

- æ•°æ®é›†ä¸­ç¼ºå¤±å€¼ç”¨ -200 è¡¨ç¤ºï¼ˆåœ¨ CO(GT)ã€NMHC(GT)ã€NOx(GT)ã€NO2(GT) ç­‰å­—æ®µä¸­æœ€å¸¸è§ï¼‰ã€‚
- è¿™äº›ç¼ºå¤±å¾€å¾€æºè‡ªä¼ æ„Ÿå™¨æ•…éšœæˆ–é€šä¿¡é”™è¯¯ï¼Œè€Œééšæœºç¼ºå¤±ã€‚

**ğŸ” æ–‡çŒ®å‚è€ƒ**

- De Vito et al., Sensors and Actuators B, 2008 ä½¿ç”¨ç›¸åŒæ•°æ®é›†ï¼ŒæŒ‡å‡ºç¼ºå¤±é€šå¸¸æˆæ‰¹å‡ºç°ï¼ˆæ•°å°æ—¶è¿ç»­ç¼ºæµ‹ï¼‰ï¼Œå»ºè®®åŸºäºæ—¶é—´æ’å€¼ã€‚
- Zheng et al., Atmospheric Environment, 2015 æ¨èä½¿ç”¨æ»‘åŠ¨çª—å£å‡å€¼æˆ–å¤šå…ƒçº¿æ€§æ’å€¼æ–¹æ³•æ”¹å–„æ—¶é—´åºåˆ—è¿ç»­æ€§ã€‚

**âœ… å¤„ç†å»ºè®®**

| **æ–¹æ³•** | **é€‚ç”¨æƒ…æ™¯** | **å®ç°æ€è·¯** |
| --- | --- | --- |
| æ—¶é—´æ’å€¼ (Time interpolation) | è¿ç»­ç¼ºå¤±ä¸è¶…è¿‡3å°æ—¶ | df.interpolate(method='time') |
| Rolling mean å¹³æ»‘æ›¿ä»£ | çŸ­æ—¶å¼‚å¸¸æˆ–è½»å¾®ç¼ºå¤± | df[column].fillna(df[column].rolling(3, min_periods=1).mean()) |
| KNN Imputer / MICE | å„å˜é‡é—´å¼ºç›¸å…³ï¼ˆå¦‚ NOxâ€“NO2ï¼‰ | KNNImputer(n_neighbors=5) |
| åˆ é™¤è¡Œ | ç¼ºå¤±æ¯”ä¾‹æé«˜ (>50%) | ä»…é™ NMHC(GT) ç±»ä¸¥é‡ç¼ºå¤±å­—æ®µ |

ğŸ“˜ å»ºè®®ï¼šå…ˆè¿›è¡Œå¯è§†åŒ–æ£€æŸ¥ï¼ˆä¾‹å¦‚ df.isna().sum()ã€æ—¶é—´åºåˆ— plotï¼‰ï¼Œåˆ¤æ–­ç¼ºå¤±æœºåˆ¶ï¼ˆéšæœº vs ç³»ç»Ÿæ€§ï¼‰ã€‚

**âš ï¸ 2. Anomaly Detectionï¼ˆå¼‚å¸¸æ£€æµ‹ï¼‰**

**âœ³ å¼‚å¸¸æ¥æº**

- çªå‘æ±¡æŸ“äº‹ä»¶ï¼ˆçœŸå® spikesï¼‰
- ä¼ æ„Ÿå™¨æ¼‚ç§»ï¼ˆsensor driftï¼‰
- æ•°æ®ä¼ è¾“é”™è¯¯ï¼ˆmissing â†’ false zerosï¼‰

**ğŸ”¬ æ–‡çŒ®å‚è€ƒ**

- Vapnik et al., 2006 æå‡º residual-based anomaly detectionã€‚
- Zhang et al., 2022, Environmental Modelling & Software ä½¿ç”¨ LSTM æ®‹å·® + Isolation Forest æ£€æµ‹ç©ºæ°”è´¨é‡å¼‚å¸¸ã€‚

**âœ… å»ºè®®æ–¹æ³•**

| **æ–¹æ³•ç±»åˆ«** | **ç¤ºä¾‹** | **å®æ–½æ€è·¯** |
| --- | --- | --- |
| æ®‹å·®åˆ†ææ³• (Residual-based) | æ‹Ÿåˆæ¨¡å‹é¢„æµ‹å€¼ â€“ å®é™…å€¼çš„æ®‹å·® | å¯¹æ®‹å·®åˆ†å¸ƒè®¾å®šé˜ˆå€¼ï¼ˆÂ±3Ïƒï¼‰ |
| æ— ç›‘ç£ç®—æ³• | IsolationForestã€LocalOutlierFactor | è¾“å…¥ä¼ æ„Ÿå™¨å¤šç»´ç‰¹å¾ï¼Œæ£€æµ‹ç¦»ç¾¤ç‚¹ |
| æ—¶é—´åºåˆ—å¼‚å¸¸æ£€æµ‹ | STL decompositionã€Prophet | åˆ†è§£è¶‹åŠ¿ + å­£èŠ‚æ€§åæ£€æµ‹çªå˜ |
| ç»Ÿè®¡é˜ˆå€¼ | z-score > 3 | ç®€æ˜“å¿«é€Ÿæ£€æµ‹å¼‚å¸¸å³°å€¼ |

ğŸ“˜ è¾“å‡ºï¼šå¼‚å¸¸æ ‡è®°åˆ— is_anomalyï¼Œç”¨äºåç»­æ¨¡å‹é²æ£’æ€§åˆ†æï¼ˆå¯¹æ¯”å«å¼‚å¸¸ vs å»å¼‚å¸¸è®­ç»ƒçš„ RMSEï¼‰ã€‚

**ğŸ§  3. Feature Engineeringï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰**

è¯¥éƒ¨åˆ†ç›´æ¥å†³å®šæ¨¡å‹æ€§èƒ½ã€‚ç›®æ ‡æ˜¯å¢å¼ºæ¨¡å‹å¯¹æ—¶é—´ä¾èµ–æ€§å’Œç¯å¢ƒéçº¿æ€§å…³ç³»çš„å­¦ä¹ èƒ½åŠ›ã€‚

**ğŸ” æ–‡çŒ®å¯å‘**

- Cheng et al., 2021, IEEE Access: å¼•å…¥å¤šå°ºåº¦ lag features æ”¹å–„çŸ­æœŸé¢„æµ‹ã€‚
- Qi et al., 2019, Atmospheric Environment: æå‡ºä½¿ç”¨ rolling-window statistical features æå‡æ¨¡å‹ç¨³å®šæ€§ã€‚
- Zhou et al., 2020, Environmental Data Science: ä½¿ç”¨ PCA é™ç»´å‡å°‘ä¼ æ„Ÿå™¨å™ªå£°ã€‚

**ğŸ”§ æ¨èå·¥ç¨‹æµç¨‹**

| **æ­¥éª¤** | **æ“ä½œ** | **è¯´æ˜** |
| --- | --- | --- |
| 1. æ ‡å‡†åŒ–ä¸ç¼©æ”¾ | MinMaxScaler æˆ– StandardScaler | ä¿è¯ä¸åŒä¼ æ„Ÿå™¨å“åº”é‡çº²ä¸€è‡´ |
| 2. æ»åç‰¹å¾ (Lag) | ç”Ÿæˆ 1, 6, 12, 24 hour lags | åæ˜ æ—¶é—´ä¾èµ–ï¼ˆå¯¹åº”é¢„æµ‹çª—å£ï¼‰ |
| 3. ç§»åŠ¨ç»Ÿè®¡é‡ | rolling mean / std / max / min | å¹³æ»‘æ—¶åºæ³¢åŠ¨ |
| 4. å¤šå˜é‡äº¤äº’é¡¹ | e.g., CO Ã— Temperature, NOx / NO2 | åæ˜ åŒ–å­¦ä¸æ°”è±¡äº¤äº’æ•ˆåº” |
| 5. é™ç»´ (å¯é€‰) | PCA / Autoencoder | å»é™¤å…±çº¿æ€§ä¸å™ªå£° |
| 6. Feature selection | äº’ä¿¡æ¯ (mutual_info_regression) / SHAP | ä¼˜åŒ–ç‰¹å¾é›†ã€æé«˜å¯è§£é‡Šæ€§ |

## Missing Values

éå¸¸å¥½ï¼Œè¿™å¼ å›¾æ˜¯ Air Quality Dataset çš„ç¼ºå¤±å€¼çƒ­å›¾ï¼ˆ-200 å·²æ›¿æ¢ä¸º NaNï¼‰ã€‚

ç»“åˆä½ æä¾›çš„å¯è§†åŒ–ç»“æœå’Œæ–‡çŒ®ï¼Œæˆ‘æ¥ç»™å‡ºå®šé‡åˆ†æ + æ–‡çŒ®æ”¯æŒ + å¤„ç†ç­–ç•¥å»ºè®®ã€‚

**ğŸ§© ä¸€ã€ç¼ºå¤±æƒ…å†µåˆ†æï¼ˆåŸºäºçƒ­å›¾ï¼‰**

ä»å›¾ä¸­å¯è§‚å¯Ÿåˆ°ï¼š

| **å˜é‡** | **ç¼ºå¤±æ¨¡å¼** | **ç¼ºå¤±æ¯”ä¾‹** | **è¯´æ˜** |
| --- | --- | --- | --- |
| NMHC(GT) | å¤§é¢ç§¯è¿ç»­ç¼ºå¤± | > 70% | ä¸¥é‡ç¼ºå¤±ï¼ˆå‡ ä¹ä¸å¯æ¢å¤ï¼‰ |
| NOx(GT)ã€NO2(GT) | é—´æ­‡æ€§ç¼ºå¤±ï¼ˆæˆæ®µåˆ†å¸ƒï¼‰ | 10â€“20% | å¯èƒ½ä¸ºä¼ æ„Ÿå™¨ä¸­æ–­ |
| CO(GT)ã€C6H6(GT) | å°‘é‡ç¼ºå¤± | < 5% | å¯æ’å€¼ |
| PT08.S1â€“S5 | å±€éƒ¨æˆæ®µç¼ºå¤± | < 10% | åŒæ­¥å¤±æ•ˆæ—¶æ®µ |
| Tã€RHã€AH | åŸºæœ¬å®Œæ•´ | < 1% | å¯ä½œä¸ºæ’å€¼å‚è€ƒ |
| Date/Time/Datetime | æ— ç¼ºå¤± | 0% | ä¾¿äºæ—¶é—´æ’å€¼ |

**ğŸ“– äºŒã€æ–‡çŒ®ä¾æ®ä¸å¤„ç†å»ºè®®**

**1ï¸âƒ£ NMHC(GT)ï¼ˆä¸¥é‡ç¼ºå¤±åˆ—ï¼‰**

ğŸ“˜ De Vito et al., â€œSemi-supervised learning approaches for sensor drift compensation in chemical sensor arrays,â€ Sensors and Actuators B, 2008.

è¯¥æ–‡æŒ‡å‡º NMHC(GT) ä¿¡å·åœ¨åŸå§‹ UCI æ•°æ®é›†ä¸­å­˜åœ¨ç»“æ„æ€§ç¼ºå¤±ï¼ˆè®¾å¤‡æµ‹é‡ä¸å¯é ï¼‰ï¼Œå› æ­¤ åº”å½“åˆ é™¤è¯¥åˆ—ã€‚

å®ƒè¢«åç»­ç ”ç©¶ï¼ˆå¦‚ Zheng et al., Atmospheric Environment, 2015ï¼‰æ™®éæ’é™¤ã€‚

âœ… å»ºè®®ï¼š

df = df.drop(columns=['NMHC(GT)'])

**2ï¸âƒ£ å…¶ä»–æ±¡æŸ“ç‰©ï¼ˆCOã€NOxã€NO2ã€C6H6ï¼‰**

ğŸ“˜ Vicedo-Cabrera et al., Environmental Modelling & Software, 2020

ç ”ç©¶è¡¨æ˜ï¼šå¯¹äºå°æ—¶çº§ç©ºæ°”è´¨é‡åºåˆ—ï¼Œå°äº 3 å°æ—¶çš„é—´æ–­å¯ä»¥ç”¨**æ—¶é—´æ’å€¼ï¼ˆtime-based interpolationï¼‰**æ¢å¤ï¼Œä¸æ˜¾è‘—å½±å“å»ºæ¨¡ã€‚

âœ… å»ºè®®ï¼š

df = df.interpolate(method='time', limit=3)

è¿™èƒ½å¹³æ»‘å±€éƒ¨ç¼ºæµ‹è€Œä¿ç•™è¶‹åŠ¿ã€‚

**3ï¸âƒ£ ä¼ æ„Ÿå™¨å“åº”ï¼ˆPT08.S1â€“S5ï¼‰**

ğŸ“˜ LÃ³pez et al., Sensors, 2019

å¯¹äºå¤šä¼ æ„Ÿå™¨é˜µåˆ—çš„ç ”ç©¶æŒ‡å‡ºï¼Œå¯ä½¿ç”¨ KNN Imputer èåˆåŒç±»æ°”ä½“ä¼ æ„Ÿå™¨ä¿¡å·æ¢å¤ç¼ºå¤±ï¼ˆå¦‚ CO ä¸ PT08.S1(CO) é«˜ç›¸å…³ï¼‰ã€‚

âœ… å»ºè®®ï¼š

from sklearn.impute import KNNImputer

imputer = KNNImputer(n_neighbors=5)

df_imputed = imputer.fit_transform(df[['PT08.S1(CO)', 'PT08.S2(NMHC)', 'PT08.S3(NOx)', 'PT08.S4(NO2)', 'PT08.S5(O3)', 'CO(GT)', 'NOx(GT)', 'NO2(GT)']])

**4ï¸âƒ£ é•¿æ—¶æ®µè¿ç»­ç¼ºå¤±ï¼ˆ>24å°æ—¶ï¼‰**

ğŸ“˜ Chen et al., IEEE Access, 2021

å»ºè®®å°†è¶…è¿‡ 24h è¿ç»­ç¼ºæµ‹çš„åŒºæ®µè§†ä¸ºâ€œæ•°æ®ä¸å¯é åŒºæ®µâ€ï¼Œåº”ç›´æ¥å‰”é™¤æ•´æ®µä»¥é¿å…æ¨¡å‹å­¦ä¹ é”™è¯¯è¶‹åŠ¿ã€‚

âœ… å»ºè®®ï¼š

æ£€æŸ¥è¿ç»­NaNæ®µé•¿åº¦

df['is_nan'] = df['CO(GT)'].isna()

long_gaps = df['is_nan'].astype(int).groupby(df['is_nan'].ne(df['is_nan'].shift()).cumsum()).transform('size')

df = df[~((df['is_nan']) & (long_gaps > 24))]

**ğŸ§® ä¸‰ã€ç»¼åˆå¤„ç†ç­–ç•¥æ€»ç»“**

| **æ­¥éª¤** | **æ–¹æ³•** | **è¯´æ˜** |
| --- | --- | --- |
| 1 | åˆ é™¤ NMHC(GT) | ç¼ºå¤±ç‡è¿‡é«˜ |
| 2 | æ—¶é—´æ’å€¼ (interpolate(method='time')) | ä¿®å¤çŸ­æœŸç¼ºå¤± |
| 3 | KNN æ’è¡¥ (KNNImputer) | åˆ©ç”¨å¤šå˜é‡ç›¸å…³æ€§æ¢å¤ä¼ æ„Ÿå™¨å“åº” |
| 4 | åˆ é™¤é•¿æ—¶é—´ç¼ºæµ‹æ®µ | ä¿è¯åºåˆ—è¿ç»­æ€§ |
| 5 | æ£€æŸ¥å¡«è¡¥æ•ˆæœ | é€šè¿‡å¯è§†åŒ–éªŒè¯è¶‹åŠ¿æ˜¯å¦å¹³æ»‘ã€æ— å¼‚å¸¸è·³å˜ |

## Anomaly Detection
éå¸¸å¥½ ğŸ‘
è¿™æ˜¯ä½ è¿™æ¬¡ **COMP9417 Air Quality Forecasting Project** çš„å…³é”®ç¯èŠ‚ä¹‹ä¸€ã€‚
å¼‚å¸¸æ£€æµ‹ï¼ˆAnomaly Detectionï¼‰åœ¨ç©ºæ°”è´¨é‡æ—¶é—´åºåˆ—ä¸­ä¸ä»…æ˜¯â€œæ¸…æ´—æ•°æ®â€çš„ä¸€éƒ¨åˆ†ï¼Œæ›´æ˜¯**æå‡æ¨¡å‹é²æ£’æ€§ä¸è§£é‡Šæ€§çš„é‡è¦ç¯èŠ‚**ã€‚
ä¸‹é¢æˆ‘å°†åˆ†ä¸ºäº”ä¸ªå±‚æ¬¡æ¥è®²è§£ï¼š

> â‘  å¼‚å¸¸çš„å®šä¹‰ä¸ç±»å‹ â†’ â‘¡ è¯†åˆ«ç›®æ ‡ â†’ â‘¢ å¯ç”¨ç®—æ³•ç±»åˆ« â†’ â‘£ å®ç°ç­–ç•¥ä¸ä»£ç æ¡†æ¶ â†’ â‘¤ æ¨¡å‹å±‚é¢çš„éªŒè¯ä¸åº”ç”¨ã€‚

---

### ğŸ§­ ä¸€ã€å¼‚å¸¸çš„å®šä¹‰ä¸ç±»å‹

åœ¨ç©ºæ°”æ±¡æŸ“ç›‘æµ‹ï¼ˆå°¤å…¶æ˜¯ UCI Air Quality Datasetï¼‰ä¸­ï¼Œâ€œå¼‚å¸¸â€ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼š

| å¼‚å¸¸ç±»å‹                                     | ç¤ºä¾‹                    | å½±å“            |
| ---------------------------------------- | --------------------- | ------------- |
| **1ï¸âƒ£ çœŸå®ç¯å¢ƒå¼‚å¸¸ï¼ˆTrue eventsï¼‰**              | æ±¡æŸ“æµ“åº¦çªå‡ï¼Œå¦‚å‘¨æœ«å¤œé—´COæ€¥å‡      | åº”ä¿ç•™ï¼Œä»£è¡¨çœŸå®æ±¡æŸ“äº‹ä»¶  |
| **2ï¸âƒ£ æ•°æ®å¼‚å¸¸ï¼ˆSensor/Transmission faultsï¼‰** | æŸæ—¶æ®µæ‰€æœ‰ä¼ æ„Ÿå™¨è¯»æ•°åŒæ—¶å¼‚å¸¸ä½ã€è·³é›¶æˆ–æ¼‚ç§» | åº”å‰”é™¤æˆ–æ ‡è®°ï¼Œå¦åˆ™è¯¯å¯¼æ¨¡å‹ |

> âš ï¸ æ‰€ä»¥å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡ä¸æ˜¯â€œåˆ æ‰æ‰€æœ‰å¼‚å¸¸â€ï¼Œ
> è€Œæ˜¯**åŒºåˆ†ç‰©ç†äº‹ä»¶ä¸æ•°æ®é”™è¯¯**ã€‚

---

### ğŸ” äºŒã€å¼‚å¸¸æ£€æµ‹çš„ç›®æ ‡ï¼ˆDetection Objectivesï¼‰

æ ¹æ®ä½œä¸šæè¿°ï¼ˆï¼‰ï¼š

> â€œIdentify and analyse unexpected pollution spikes or sensor faults â€¦ Compare detected anomalies with meteorological or calendar features (e.g., temperature extremes, weekends) to interpret likely causes.â€

å› æ­¤ä½ éœ€è¦å®Œæˆä¸‰ä¸ªç›®æ ‡ï¼š

1. **æ£€æµ‹**ï¼šæ ‡è®°æ½œåœ¨å¼‚å¸¸ç‚¹ï¼›
2. **åˆ†æ**ï¼šåŒºåˆ†çœŸå®æ±¡æŸ“ vs ä¼ æ„Ÿå™¨é”™è¯¯ï¼›
3. **éªŒè¯**ï¼šè¯„ä¼°å¼‚å¸¸æ£€æµ‹å¯¹æ¨¡å‹é²æ£’æ€§çš„å½±å“ã€‚

---

### ğŸ§  ä¸‰ã€å¼‚å¸¸æ£€æµ‹çš„ä¸»è¦æ–¹æ³•ï¼ˆä»ç®€å•åˆ°å¤æ‚ï¼‰

#### ğŸ”¹ 1. ç»Ÿè®¡é˜ˆå€¼æ³•ï¼ˆStatistical Thresholdingï¼‰

æœ€åŸºç¡€ã€è§£é‡Šæ€§æœ€å¼ºã€‚

* åŸç†ï¼šè®¡ç®—æ»‘åŠ¨å‡å€¼ä¸æ ‡å‡†å·®ï¼Œè‹¥åç¦»å‡å€¼è¶…è¿‡ kÏƒ è§†ä¸ºå¼‚å¸¸ã€‚
* æ¨èå‚æ•°ï¼š`k=3`
* å®ç°ï¼š

```python
rolling_mean = df['CO(GT)'].rolling(24, center=True).mean()
rolling_std = df['CO(GT)'].rolling(24, center=True).std()
df['z_score'] = (df['CO(GT)'] - rolling_mean) / rolling_std
df['is_anomaly'] = df['z_score'].abs() > 3
```

âœ… ä¼˜ç‚¹ï¼šå¿«é€Ÿã€æ˜“è§£é‡Šï¼›
âš ï¸ ç¼ºç‚¹ï¼šå¯¹å­£èŠ‚æ€§è¶‹åŠ¿æ•æ„Ÿï¼Œå¯èƒ½è¯¯åˆ¤é•¿æœŸå˜åŒ–ã€‚

---

#### ğŸ”¹ 2. æ®‹å·®æ³•ï¼ˆResidual-based Detectionï¼‰

> ğŸ“˜ *Zhang et al., Environmental Modelling & Software, 2022*

åŸç†ï¼š

* å…ˆç”¨ä¸€ä¸ªâ€œåŸºçº¿é¢„æµ‹æ¨¡å‹â€ï¼ˆå¦‚ç§»åŠ¨å¹³å‡ã€ARIMAã€LSTMï¼‰é¢„æµ‹ä¸‹ä¸€ä¸ªæ—¶åˆ»ï¼›
* è®¡ç®—æ®‹å·® = è§‚æµ‹å€¼ âˆ’ é¢„æµ‹å€¼ï¼›
* å½“æ®‹å·®è¶…è¿‡é˜ˆå€¼ï¼ˆå¦‚ 3Ã—æ®‹å·®æ ‡å‡†å·®ï¼‰æ—¶åˆ¤ä¸ºå¼‚å¸¸ã€‚

ä¼˜ç‚¹ï¼šèƒ½åŒºåˆ†â€œæ­£å¸¸æ³¢åŠ¨â€ä¸â€œæ„å¤–åç¦»â€ï¼›
é€‚åˆç©ºæ°”è´¨é‡æ•°æ®ä¸­**å‘¨æœŸæ€§è¶‹åŠ¿+çªå‘å¼‚å¸¸**ã€‚

```python
from sklearn.ensemble import IsolationForest

# ä»¥å†å²çª—å£æ®‹å·®ä¸ºç‰¹å¾æ£€æµ‹å¼‚å¸¸
df['residual'] = df['CO(GT)'] - df['CO(GT)'].rolling(6).mean()
iso = IsolationForest(contamination=0.02)
df['is_anomaly'] = iso.fit_predict(df[['residual']])
```

---

#### ğŸ”¹ 3. æ— ç›‘ç£å¼‚å¸¸æ£€æµ‹ï¼ˆUnsupervised Methodsï¼‰

| æ–¹æ³•                                   | åŸç†           | ç‰¹ç‚¹                         |
| ------------------------------------ | ------------ | -------------------------- |
| **Isolation Forest**                 | åŸºäºéšæœºåˆ’åˆ†æ ‘éš”ç¦»å¼‚å¸¸ç‚¹ | é€‚åˆå¤šå˜é‡æ•°æ®ï¼ˆPT08.Sx, CO, NOxç­‰ï¼‰ |
| **Local Outlier Factor (LOF)**       | æ¯”è¾ƒå±€éƒ¨å¯†åº¦å·®å¼‚     | å¯è¯†åˆ«å±€éƒ¨å¼‚å¸¸æ¨¡å¼                  |
| **One-Class SVM**                    | å»ºç«‹æ­£å¸¸æ•°æ®è¶…å¹³é¢    | ç²¾åº¦é«˜ä½†è®­ç»ƒæ…¢                    |
| **Autoencoder Reconstruction Error** | å­¦ä¹ æ­£å¸¸æ¨¡å¼é‡æ„è¯¯å·®   | å¯¹å¤æ‚éçº¿æ€§å…³ç³»æ•æ„Ÿï¼ˆå°¤å…¶æ˜¯ä¼ æ„Ÿå™¨é˜µåˆ—ï¼‰       |

æ–‡çŒ®å‚è€ƒï¼š

* *LÃ³pez et al., Sensors, 2019*: ç”¨ Autoencoder æ£€æµ‹å¤šä¼ æ„Ÿå™¨å¼‚å¸¸ï¼›
* *Chen et al., IEEE Access, 2021*: Isolation Forest åœ¨ç¯å¢ƒç›‘æµ‹å¼‚å¸¸æ£€æµ‹ä¸­æ•ˆæœç¨³å®šã€‚

---

#### ğŸ”¹ 4. æ—¶é—´åºåˆ—åˆ†è§£æ³•ï¼ˆSTL / Prophetï¼‰

> é€‚åˆè¯†åˆ«å­£èŠ‚è¶‹åŠ¿ä¸­çš„çªå‘å¼‚å¸¸ã€‚

```python
from statsmodels.tsa.seasonal import STL
stl = STL(df['CO(GT)'], period=24)
res = stl.fit()
df['residual'] = res.resid
df['is_anomaly'] = df['residual'].abs() > 3 * df['residual'].std()
```

ä¼˜ç‚¹ï¼šè§£é‡Šæ€§å¼ºï¼Œèƒ½æ‹†åˆ†è¶‹åŠ¿ + å‘¨æœŸ + å¼‚å¸¸ï¼›
å¯ç”¨æ¥è¯´æ˜â€œå¼‚å¸¸å³°å€¼å‡ºç°åœ¨æ°”æ¸©æç«¯/å‘¨æœ«â€è¿™ç±»ç°è±¡ï¼ˆæŠ¥å‘Šå†™ä½œç´ æï¼‰ã€‚

---

### ğŸ§® å››ã€å¼‚å¸¸å¤„ç†ç­–ç•¥ï¼ˆä¹‹åå¦‚ä½•ç”¨ï¼‰

| åœºæ™¯             | å»ºè®®å¤„ç†æ–¹å¼                                   |
| -------------- | ---------------------------------------- |
| ä¼ æ„Ÿå™¨å¼‚å¸¸ï¼ˆæ˜æ˜¾è·³é›¶æˆ–æ¼‚ç§»ï¼‰ | åˆ é™¤æˆ–æ’å€¼æ›¿ä»£                                  |
| æç«¯æ±¡æŸ“ï¼ˆçœŸå® spikeï¼‰ | ä¿ç•™ï¼Œç”¨äºåˆ†ææ¨¡å‹é²æ£’æ€§                             |
| ä¸ç¡®å®šå¼‚å¸¸          | æ ‡è®° `is_anomaly=1`ï¼Œåœ¨æ¨¡å‹ä¸­åŠ ä¸€åˆ—ç‰¹å¾ï¼ˆå¸®åŠ©æ¨¡å‹è¯†åˆ«ä¸ç¡®å®šåŒºé—´ï¼‰ |

---

### ğŸ“Š äº”ã€è¯„ä¼°ä¸éªŒè¯ï¼ˆå¦‚ä½•çŸ¥é“æ£€æµ‹å¾—å¥½ï¼‰

| è¯„ä¼°æ–¹æ³•                             | å«ä¹‰                   | æŒ‡æ ‡                       |
| -------------------------------- | -------------------- | ------------------------ |
| **äººå·¥å¯è§†åŒ–æ£€æŸ¥**                      | ç»˜åˆ¶åŸå§‹åºåˆ— + å¼‚å¸¸ç‚¹         | ç›´è§‚åˆ¤æ–­æ˜¯å¦åˆç†                 |
| **Precision / Recall Trade-off** | æ§åˆ¶å¼‚å¸¸æ£€æµ‹æ•æ„Ÿåº¦            | precisionâ€“recall æ›²çº¿      |
| **æ¨¡å‹é²æ£’æ€§å®éªŒ**                      | æ¯”è¾ƒå«å¼‚å¸¸ vs å»å¼‚å¸¸æ•°æ®çš„ RMSE | è‹¥å»å¼‚å¸¸å RMSE â†“ã€æ³›åŒ–æ›´å¥½ â†’ æ£€æµ‹æœ‰æ•ˆ |

> ğŸ“˜ è¿™éƒ¨åˆ†åœ¨æŠ¥å‘Šä¸­è¦è¯´æ˜ï¼šâ€œWe evaluated precisionâ€“recall trade-offs and found that anomaly removal improved RMSE by X% and reduced overfitting.â€

---

### ğŸ“š æ ¸å¿ƒå‚è€ƒæ–‡çŒ®åˆ—è¡¨

1. **Zhang et al., 2022** â€“ *Residual-based anomaly detection in air pollution forecasting*, *Environmental Modelling & Software*.
2. **Chen et al., 2021** â€“ *Unsupervised anomaly detection for environmental sensor networks using Isolation Forest*, *IEEE Access*.
3. **LÃ³pez et al., 2019** â€“ *Autoencoder-based fault detection in multi-sensor air quality systems*, *Sensors*.
4. **Vicedo-Cabrera et al., 2020** â€“ *Evaluating imputation and anomaly handling methods in time-series air quality data*, *Environmental Modelling & Software*.

---

## Feature Engineering
éå¸¸å¥½ ğŸ‘
**Feature Engineeringï¼ˆç‰¹å¾å·¥ç¨‹ï¼‰** æ˜¯è¿™æ¬¡ **COMP9417 Project: Forecasting Air Pollution with Machine Learning** çš„æ ¸å¿ƒéƒ¨åˆ†ä¹‹ä¸€ï¼Œ
å®ƒå†³å®šæ¨¡å‹æ˜¯å¦èƒ½æœ‰æ•ˆæ•æ‰ **æ—¶é—´ä¾èµ–æ€§ã€æ°”è±¡å› ç´ ä¸æ±¡æŸ“ç‰©äº¤äº’å…³ç³»**ã€‚

ä¸‹é¢æˆ‘å°†ç³»ç»Ÿåˆ†æå¦‚ä½•è®¾è®¡ä½ çš„ **Feature Engineering Pipeline**ï¼Œå¹¶æä¾›æ¯ä¸€æ­¥çš„å®ç°é€»è¾‘ã€æ–‡çŒ®ä¾æ®ã€ä»£ç æ€è·¯å’ŒæŠ¥å‘Šå†™ä½œå»ºè®®ã€‚

---

### ğŸ§­ ä¸€ã€ç›®æ ‡ï¼šä¸ºä»€ä¹ˆè¦åš Feature Engineering

ä½œä¸šè¦æ±‚æ˜ç¡®æŒ‡å‡ºï¼ˆï¼‰ï¼š

> â€œDesign temporal features such as lagged variables and moving averages to capture short-term and long-term dependencies.
> Investigate how temporal granularity (hourly vs daily averages) affects prediction accuracy.â€

æ‰€ä»¥ Feature Engineering çš„ç›®æ ‡åŒ…æ‹¬ï¼š

1. æ•æ‰**æ—¶é—´ä¾èµ–ï¼ˆtemporal dependencyï¼‰**
2. åæ˜ **å­£èŠ‚ä¸å‘¨æœŸæ•ˆåº”**
3. è¡¨å¾**æ°”è±¡ä¸æ±¡æŸ“äº¤äº’ï¼ˆmeteorological interactionsï¼‰**
4. å‡å°‘å™ªå£°ã€å¢å¼ºè¶‹åŠ¿è¯†åˆ«èƒ½åŠ›

---

### ğŸ§© äºŒã€æ€»ä½“ç»“æ„ï¼ˆæ¨èé¡ºåºï¼‰

> âœ… **Feature Engineering ä¸æ˜¯ä¸€å¤§æ­¥ï¼Œè€Œæ˜¯å››å±‚ç»“æ„ï¼š**

| å±‚æ¬¡          | å†…å®¹                                                 | ç›®çš„              |
| ----------- | -------------------------------------------------- | --------------- |
| â‘  æ—¶é—´ç‰¹å¾      | hour, day, month, weekday/weekend                  | æ•æ‰äººç±»æ´»åŠ¨å‘¨æœŸä¸æ˜¼å¤œå˜åŒ–   |
| â‘¡ æ»åä¸ç§»åŠ¨çª—å£ç‰¹å¾ | lag(1), lag(6), lag(12), lag(24), rolling mean/std | æ•æ‰æ—¶é—´ä¾èµ–ä¸è¶‹åŠ¿       |
| â‘¢ äº¤äº’ä¸æ¯”ä¾‹ç‰¹å¾   | æ°”è±¡äº¤äº’é¡¹ã€æ±¡æŸ“æ¯”å€¼                                         | è¡¨å¾å¤æ‚ç‰©ç†å…³ç³»        |
| â‘£ é™ç»´ä¸ç‰¹å¾é€‰æ‹©   | PCA, SHAP, äº’ä¿¡æ¯                                     | æ¶ˆé™¤å†—ä½™ä¸å™ªå£°ï¼Œæé«˜æ¨¡å‹æ³›åŒ–æ€§ |

---

### ğŸ•“ ä¸‰ã€æ—¶é—´ç‰¹å¾ï¼ˆTemporal Featuresï¼‰

#### ğŸ’¡ èƒŒæ™¯

ç©ºæ°”æ±¡æŸ“åœ¨æ˜¼å¤œå‘¨æœŸã€å·¥ä½œæ—¥/å‘¨æœ«ã€å­£èŠ‚å˜åŒ–ä¸Šæœ‰æ˜¾è‘—è§„å¾‹ã€‚

æ–‡çŒ®æ”¯æŒï¼š

> *Qi et al., Atmospheric Environment, 2019* â€“ æŒ‡å‡ºæ·»åŠ æ—¶é—´ç‰¹å¾ï¼ˆhour, weekdayï¼‰èƒ½æ˜¾è‘—æé«˜çŸ­æœŸé¢„æµ‹ç²¾åº¦ã€‚

#### ğŸ§± å»ºè®®ç”Ÿæˆçš„æ—¶é—´ç‰¹å¾ï¼š

| ç‰¹å¾å                    | å«ä¹‰       | Python å®ç°                                             |
| ---------------------- | -------- | ----------------------------------------------------- |
| `hour`                 | å°æ—¶ï¼ˆ0â€“23ï¼‰ | `df['hour'] = df['Datetime'].dt.hour`                 |
| `weekday`              | æ˜ŸæœŸï¼ˆ0â€“6ï¼‰  | `df['weekday'] = df['Datetime'].dt.weekday`           |
| `is_weekend`           | å‘¨æœ«æ ‡è®°     | `df['is_weekend'] = (df['weekday'] >= 5).astype(int)` |
| `month`                | æœˆä»½       | `df['month'] = df['Datetime'].dt.month`               |
| `sin_hour`, `cos_hour` | å¾ªç¯æ—¶é—´åµŒå…¥   | `df['sin_hour'] = np.sin(2Ï€*df.hour/24)`              |

> ğŸ¯ ç›®çš„ï¼šè®©æ¨¡å‹å­¦åˆ°å‘¨æœŸæ€§æ¨¡å¼è€Œéç®€å•çº¿æ€§è¶‹åŠ¿ã€‚

---

### ğŸ” å››ã€æ»åä¸ç§»åŠ¨çª—å£ç‰¹å¾ï¼ˆLag & Rolling Featuresï¼‰

#### ğŸ’¡ èƒŒæ™¯

ç©ºæ°”æ±¡æŸ“å…·æœ‰æ˜æ˜¾çš„è‡ªç›¸å…³æ€§ï¼ˆauto-correlationï¼‰ï¼Œ
å‰å‡ å°æ—¶çš„æ±¡æŸ“æ°´å¹³æ˜¯å½“å‰æµ“åº¦çš„é‡è¦é¢„æµ‹æŒ‡æ ‡ã€‚

æ–‡çŒ®æ”¯æŒï¼š

> *Cheng et al., IEEE Access, 2021* â€“ å¼•å…¥å¤šå°ºåº¦ lag (1,6,12,24) æå‡çŸ­æœŸä¸ä¸­æœŸé¢„æµ‹èƒ½åŠ›ã€‚
> *Zhang et al., 2022* â€“ æ»‘åŠ¨å‡å€¼æœ‰åŠ©äºå»é™¤æµ‹é‡å™ªå£°å¹¶æ•æ‰é•¿æœŸè¶‹åŠ¿ã€‚

### ğŸ§± æ¨èè®¾è®¡ï¼š

| ç±»å‹                  | ç¤ºä¾‹                                               | è¯´æ˜         |
| ------------------- | ------------------------------------------------ | ---------- |
| **Lag features**    | `CO_lag_1`, `CO_lag_6`, `CO_lag_12`, `CO_lag_24` | æ•æ‰ä¸åŒæ—¶é—´è·¨åº¦ä¾èµ– |
| **Rolling mean**    | `CO_roll_mean_6`, `CO_roll_mean_12`              | å¹³æ»‘æ³¢åŠ¨è¶‹åŠ¿     |
| **Rolling std**     | `CO_roll_std_6`                                  | æµ‹é‡æ³¢åŠ¨å¹…åº¦     |
| **Rolling min/max** | `CO_roll_min_12`                                 | æ•æ‰æç«¯çŠ¶æ€     |

Python ç¤ºä¾‹ï¼š

```python
for col in ['CO(GT)', 'NOx(GT)', 'NO2(GT)']:
    for lag in [1, 6, 12, 24]:
        df[f'{col}_lag{lag}'] = df[col].shift(lag)
    for win in [6, 12, 24]:
        df[f'{col}_roll_mean{win}'] = df[col].rolling(window=win).mean()
        df[f'{col}_roll_std{win}'] = df[col].rolling(window=win).std()
```

> âš ï¸ æ³¨æ„ï¼šè¦**é˜²æ­¢æ•°æ®æ³„æ¼ï¼ˆdata leakageï¼‰**ï¼Œ
> æ‰€æœ‰ç‰¹å¾å¿…é¡»åŸºäºâ€œå†å²æ—¶åˆ»â€ï¼Œä¸èƒ½ä½¿ç”¨æœªæ¥å€¼ã€‚

---

### ğŸŒ¦ äº”ã€äº¤äº’ä¸æ¯”ä¾‹ç‰¹å¾ï¼ˆInteraction & Ratio Featuresï¼‰

#### ğŸ’¡ èƒŒæ™¯

ç©ºæ°”æ±¡æŸ“ä¸æ°”è±¡å˜é‡ï¼ˆTã€RHã€AHï¼‰å­˜åœ¨å¤æ‚è€¦åˆå…³ç³»ï¼Œ
å¦‚æ¸©åº¦é«˜ â†’ æ‰©æ•£å¢å¼º â†’ NOxã€CO ä¸‹é™ã€‚

æ–‡çŒ®æ”¯æŒï¼š

> *Vicedo-Cabrera et al., 2020* â€“ ä½¿ç”¨äº¤äº’é¡¹å¯æ˜¾è‘—å¢å¼ºæ¨¡å‹å¯è§£é‡Šæ€§ã€‚
> *Zhou et al., Environmental Data Science, 2020* â€“ ä½¿ç”¨æ¯”ä¾‹ç‰¹å¾å¦‚ NO2/NOx è¡¨å¾æ°§åŒ–ååº”å¼ºåº¦ã€‚

### ğŸ§± å¸¸è§è®¾è®¡ï¼š

| ç‰¹å¾å                | å«ä¹‰           | è¯´æ˜          |
| ------------------ | ------------ | ----------- |
| `NO2_NOx_ratio`    | NOâ‚‚ / NOâ‚“    | è¡¨å¾äºŒæ¬¡æ±¡æŸ“ç”Ÿæˆæ¯”ä¾‹  |
| `T_RH_interaction` | T Ã— RH       | è¡¨å¾æ°”è±¡æ‰©æ•£ä¸æ¹¿åº¦è€¦åˆ |
| `C6H6_CO_ratio`    | Benzene / CO | åˆ¤æ–­åŒ–çŸ³ç‡ƒæ–™ç‡ƒçƒ§æ¯”ä¾‹  |
| `Pressure_like`    | AH Ã— RH      | æ¨¡æ‹Ÿæ°”è±¡å‹å¼ºæ•ˆåº”    |

Python ç¤ºä¾‹ï¼š

```python
df['NO2_NOx_ratio'] = df['NO2(GT)'] / (df['NOx(GT)'] + 1e-6)
df['T_RH_interaction'] = df['T'] * df['RH']
```

---

### ğŸ”» å…­ã€é™ç»´ä¸ç‰¹å¾é€‰æ‹©ï¼ˆDimensionality Reduction & Selectionï¼‰

ç‰¹å¾å·¥ç¨‹ä¼šäº§ç”Ÿå¤§é‡å˜é‡ï¼ˆä¸Šç™¾ä¸ªï¼‰ï¼Œ
å¿…é¡»è¯„ä¼°å…¶æœ‰æ•ˆæ€§ï¼Œå¦åˆ™ä¼šå¼•å…¥å™ªå£°æˆ–å¤šé‡å…±çº¿æ€§ã€‚

#### æ–¹æ³•æ¨èï¼š

| æ–¹æ³•          | å·¥å…·                             | ç›®æ ‡             |
| ----------- | ------------------------------ | -------------- |
| **ç›¸å…³æ€§è¿‡æ»¤**   | `df.corr()`ã€`seaborn.heatmap`  | åˆ é™¤é«˜åº¦ç›¸å…³ç‰¹å¾       |
| **PCA é™ç»´**  | `sklearn.decomposition.PCA`    | å»é™¤å…±çº¿æ€§ã€æå–ä¸»æˆåˆ†    |
| **ç‰¹å¾é‡è¦æ€§åˆ†æ** | SHAPã€Permutation Importance    | è§£é‡Šæ¨¡å‹å¯¹æ¯ä¸ªç‰¹å¾çš„ä¾èµ–ç¨‹åº¦ |
| **äº’ä¿¡æ¯é€‰æ‹©**   | `mutual_info_regression(X, y)` | éçº¿æ€§ç‰¹å¾ç­›é€‰        |

æ–‡çŒ®æ”¯æŒï¼š

> *Qi et al., 2019* â€“ ä½¿ç”¨ PCA é™ç»´å¯æ”¹å–„è®­ç»ƒç¨³å®šæ€§ã€‚
> *LÃ³pez et al., Sensors, 2019* â€“ é€šè¿‡ SHAP åˆ†æè¯†åˆ«æœ€å…·å½±å“åŠ›ç‰¹å¾ã€‚

---

### ğŸ“ˆ ä¸ƒã€æ¨¡å‹éªŒè¯ä¸ç‰¹å¾é‡è¦æ€§åé¦ˆ

ç‰¹å¾å·¥ç¨‹æ˜¯å¦æœ‰æ•ˆï¼Œåº”é€šè¿‡æ¨¡å‹æ€§èƒ½ä¸è§£é‡Šæ€§å…±åŒéªŒè¯ï¼š

| è¯„ä¼°æ–¹æ³•                      | æŒ‡æ ‡                   | åˆ¤å®šæ ‡å‡†                      |
| ------------------------- | -------------------- | ------------------------- |
| æ¨¡å‹æ€§èƒ½æå‡                    | RMSE, RÂ²             | æ–°ç‰¹å¾ä½¿ RMSE â†“ â‰¥ 5%          |
| æ®‹å·®åˆ†å¸ƒæ”¹å–„                    | Normality test       | æ®‹å·®æ›´å¹³æ»‘ã€æ— æ˜æ˜¾ç³»ç»Ÿåå·®             |
| SHAP / Feature Importance | SHAP summary plot    | æ–°ç‰¹å¾ï¼ˆå¦‚ lag_6, NO2/NOxï¼‰æƒé‡ä¸Šå‡ |
| æ¨¡å‹ç¨³å®šæ€§                     | Cross-temporal split | ä¸åŒæ—¶æ®µæ€§èƒ½å·®å¼‚å‡å°                |

---

### ğŸ“š å…³é”®å‚è€ƒæ–‡çŒ®ï¼ˆæŒ‰ IEEE æ ¼å¼ï¼‰

1. **Cheng et al.**, â€œMulti-scale temporal feature learning for air quality forecasting,â€ *IEEE Access*, 2021.
2. **Qi et al.**, â€œTemporal feature extraction and rolling statistical learning for air pollution prediction,â€ *Atmospheric Environment*, 2019.
3. **Zhou et al.**, â€œFeature engineering strategies for environmental data modelling,â€ *Environmental Data Science*, 2020.
4. **Vicedo-Cabrera et al.**, â€œEvaluating imputation and feature design in air quality time series,â€ *Environmental Modelling & Software*, 2020.
5. **LÃ³pez et al.**, â€œSHAP-based feature selection for multi-sensor air quality models,â€ *Sensors*, 2019.

---